var re=Object.defineProperty;var Z=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var ee=(l,p,c)=>p in l?re(l,p,{enumerable:!0,configurable:!0,writable:!0,value:c}):l[p]=c,V=(l,p)=>{for(var c in p||(p={}))oe.call(p,c)&&ee(l,c,p[c]);if(Z)for(var c of Z(p))le.call(p,c)&&ee(l,c,p[c]);return l};var f=(l,p,c)=>new Promise((_,F)=>{var $=n=>{try{y(c.next(n))}catch(g){F(g)}},I=n=>{try{y(c.throw(n))}catch(g){F(g)}},y=n=>n.done?_(n.value):Promise.resolve(n.value).then($,I);y((c=c.apply(l,p)).next())});import{c as ae,r as z,z as ne,h as x,k as S,b as k,i as a,l as b,u,I as v,t as w,y as j,n as U,p as se,K as te}from"./vue-vendor-Cs4IDGu-.js";import{a as m}from"./useAuth-C1_85XZE.js";const i=z(!1),o=z(null);function ie(){function l(){return f(this,arguments,function*(e={}){var t,r;try{i.value=!0,o.value=null;const s=new URLSearchParams;e.search&&s.append("search",e.search),e.category&&s.append("category",e.category),e.difficulty&&s.append("difficulty",e.difficulty),e.tags&&e.tags.length>0&&s.append("tags",e.tags.join(",")),e.verifiedOnly&&s.append("verifiedOnly","true"),e.sortBy&&s.append("sortBy",e.sortBy),e.page&&s.append("page",e.page),e.limit&&s.append("limit",e.limit);const d=yield m.get(`/public-flows?${s.toString()}`);return V({success:!0},d.data.data)}catch(s){return o.value=((r=(t=s.response)==null?void 0:t.data)==null?void 0:r.message)||"Erro ao carregar flows públicos",{success:!1,error:o.value}}finally{i.value=!1}})}function p(e){return f(this,null,function*(){var t,r;try{i.value=!0,o.value=null;const s=yield m.get(`/public-flows/${e}`);return V({success:!0},s.data.data)}catch(s){return o.value=((r=(t=s.response)==null?void 0:t.data)==null?void 0:r.message)||"Erro ao carregar detalhes do flow",{success:!1,error:o.value}}finally{i.value=!1}})}function c(e,t){return f(this,null,function*(){var r,s,d,C,M;try{return i.value=!0,o.value=null,{success:!0,data:(yield m.post(`/public-flows/${e}/publish`,t)).data.data}}catch(R){o.value=((s=(r=R.response)==null?void 0:r.data)==null?void 0:s.message)||"Erro ao publicar flow";const L=((M=(C=(d=R.response)==null?void 0:d.data)==null?void 0:C.error)==null?void 0:M.data)||{};return V({success:!1,error:o.value},L)}finally{i.value=!1}})}function _(e){return f(this,null,function*(){var t,r;try{return i.value=!0,o.value=null,{success:!0,data:(yield m.post(`/public-flows/${e}/unpublish`)).data.data}}catch(s){return o.value=((r=(t=s.response)==null?void 0:t.data)==null?void 0:r.message)||"Erro ao despublicar flow",{success:!1,error:o.value}}finally{i.value=!1}})}function F(e){return f(this,null,function*(){var t,r;try{return i.value=!0,o.value=null,{success:!0,data:(yield m.post(`/public-flows/${e}/import`)).data.data}}catch(s){return o.value=((r=(t=s.response)==null?void 0:t.data)==null?void 0:r.message)||"Erro ao importar flow",{success:!1,error:o.value}}finally{i.value=!1}})}function $(e){return f(this,null,function*(){var t,r;try{return i.value=!0,o.value=null,{success:!0,data:(yield m.post(`/public-flows/${e}/fork`)).data.data}}catch(s){return o.value=((r=(t=s.response)==null?void 0:t.data)==null?void 0:r.message)||"Erro ao criar fork",{success:!1,error:o.value}}finally{i.value=!1}})}function I(){return f(this,null,function*(){try{return{success:!0,data:(yield m.get("/public-flows/stats")).data.data}}catch(e){return{success:!1,error:"Erro ao carregar estatísticas"}}})}function y(r){return f(this,arguments,function*(e,t={}){try{const s=new URLSearchParams;t.sortBy&&s.append("sortBy",t.sortBy),t.page&&s.append("page",t.page),t.limit&&s.append("limit",t.limit),t.minRating&&s.append("minRating",t.minRating);const d=yield m.get(`/public-flows/${e}/reviews?${s.toString()}`);return V({success:!0},d.data.data)}catch(s){return{success:!1,error:"Erro ao carregar reviews"}}})}function n(e,t){return f(this,null,function*(){var r,s;try{return i.value=!0,o.value=null,{success:!0,data:(yield m.post(`/public-flows/${e}/reviews`,t)).data.data}}catch(d){return o.value=((s=(r=d.response)==null?void 0:r.data)==null?void 0:s.message)||"Erro ao criar review",{success:!1,error:o.value}}finally{i.value=!1}})}function g(e,t){return f(this,null,function*(){var r,s;try{return i.value=!0,o.value=null,{success:!0,data:(yield m.put(`/public-flows/reviews/${e}`,t)).data.data}}catch(d){return o.value=((s=(r=d.response)==null?void 0:r.data)==null?void 0:s.message)||"Erro ao atualizar review",{success:!1,error:o.value}}finally{i.value=!1}})}function E(e){return f(this,null,function*(){var t,r;try{return i.value=!0,o.value=null,yield m.delete(`/public-flows/reviews/${e}`),{success:!0}}catch(s){return o.value=((r=(t=s.response)==null?void 0:t.data)==null?void 0:r.message)||"Erro ao deletar review",{success:!1,error:o.value}}finally{i.value=!1}})}function P(e){return f(this,null,function*(){try{return{success:!0,data:(yield m.post(`/public-flows/reviews/${e}/helpful`)).data.data}}catch(t){return{success:!1,error:"Erro ao marcar review"}}})}function B(e){return f(this,null,function*(){try{return{success:!0,data:(yield m.get(`/public-flows/${e}/reviews/me`)).data.data}}catch(t){return{success:!1,error:"Erro ao carregar review"}}})}function h(e,t){return f(this,null,function*(){var r,s;try{return i.value=!0,o.value=null,{success:!0,data:(yield m.post(`/public-flows/${e}/report`,t)).data.data}}catch(d){return o.value=((s=(r=d.response)==null?void 0:r.data)==null?void 0:s.message)||"Erro ao reportar flow",{success:!1,error:o.value}}finally{i.value=!1}})}return{loading:ae(()=>i.value),error:ae(()=>o.value),listPublicFlows:l,getFlowDetails:p,publishFlow:c,unpublishFlow:_,importFlow:F,forkFlow:$,getLibraryStats:I,listReviews:y,createReview:n,updateReview:g,deleteReview:E,markReviewHelpful:P,getUserReview:B,reportFlow:h}}const ce={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},de={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:p-0"},ue={class:"relative inline-block w-full max-w-2xl p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-2xl rounded-2xl"},pe={key:0,class:"text-center py-8"},fe={class:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-brand-green/10 border border-brand-green/30 mb-4"},me={class:"text-lg font-semibold text-gray-900 mb-2 tracking-wide"},be={key:1},ve={class:"flex items-start justify-between mb-6"},ge={class:"text-gray-600 tracking-wide"},we={key:0,class:"mb-6 p-4 bg-brand-red/10 border border-brand-red/30 rounded-lg"},ye={class:"flex items-start"},he={class:"text-brand-red"},xe={class:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg"},ke={class:"flex items-start gap-4"},_e={class:"flex-shrink-0"},Fe={class:"w-12 h-12 bg-gradient-to-br from-brand-purple to-brand-pink rounded-lg flex items-center justify-center"},Ee={class:"flex-1"},Re={class:"font-semibold text-gray-900 mb-1"},$e={class:"text-sm text-gray-600 mb-2"},Ie={class:"flex items-center gap-4 text-sm text-gray-500"},Be={class:"flex items-center gap-1"},Ce={class:"flex items-center gap-1"},Me={class:"flex items-center gap-1"},Ve={class:"mb-6"},Se={class:"space-y-3"},je={class:"ml-3 flex-1"},ze={class:"flex items-center gap-2 mb-1"},Le={class:"ml-3 flex-1"},Pe={class:"flex items-center gap-2 mb-1"},Te={key:1,class:"p-4 bg-gray-50 border border-gray-200 rounded-lg"},Ue={class:"text-sm text-gray-600 flex items-center gap-2"},De={class:"mb-6 space-y-3"},Ne={class:"bg-brand-orange/10 border border-brand-orange/30 rounded-lg p-4"},Oe={class:"flex items-start"},Ae={class:"text-sm text-gray-700"},qe={class:"list-disc list-inside space-y-1"},He={key:0},Ke={class:"bg-brand-purple/10 border border-brand-purple/30 rounded-lg p-4"},Ge={class:"flex items-start"},Je={class:"text-sm text-gray-700"},Qe={class:"font-medium mb-1 text-brand-purple"},We={class:"flex items-center justify-end gap-3 pt-6 border-t border-gray-200"},Xe=["disabled"],aa={__name:"ImportFlowModal",props:{show:Boolean,flow:Object},emits:["close","imported"],setup(l,{emit:p}){const c=l,_=p,F=ne(),{importFlow:$,forkFlow:I,loading:y}=ie(),n=z("import"),g=z(""),E=z(!1);function P(){return f(this,null,function*(){g.value="",E.value=!1;let h;n.value==="fork"?h=yield I(c.flow._id):h=yield $(c.flow._id),h.success?(E.value=!0,_("imported",h.data),setTimeout(()=>{F.push(`/flows/${h.data._id}/edit`)},1500)):g.value=h.error})}function B(){n.value="import",g.value="",E.value=!1,_("close")}return(h,e)=>{var t,r,s,d,C,M,R,L,D,N,O,A,q,H,K,G,J,Q,W,X,Y;return l.show?(k(),x("div",ce,[a("div",de,[a("div",{class:"fixed inset-0 transition-opacity bg-gray-900/50 backdrop-blur-sm",onClick:B}),a("div",ue,[E.value?(k(),x("div",pe,[a("div",fe,[b(u(v),{icon:"lucide:check-circle",class:"w-10 h-10 text-brand-green"})]),a("h3",me,w(n.value==="fork"?"Fork criado com sucesso!":"Flow importado com sucesso!"),1),e[2]||(e[2]=a("p",{class:"text-gray-600 tracking-wide"}," Redirecionando para o editor... ",-1))])):(k(),x("div",be,[a("div",ve,[a("div",null,[e[3]||(e[3]=a("h3",{class:"text-2xl font-bold text-gray-900 mb-2 tracking-wide"}," Importar Flow ",-1)),a("p",ge,w((t=l.flow)==null?void 0:t.name),1)]),a("button",{onClick:B,class:"text-gray-500 hover:text-gray-700 hover:bg-gray-100 p-1 rounded transition-all"},[b(u(v),{icon:"lucide:x",class:"w-6 h-6"})])]),g.value?(k(),x("div",we,[a("div",ye,[b(u(v),{icon:"lucide:alert-circle",class:"w-5 h-5 text-brand-red mt-0.5 mr-2"}),a("p",he,w(g.value),1)])])):S("",!0),a("div",xe,[a("div",ke,[a("div",_e,[a("div",Fe,[b(u(v),{icon:"lucide:workflow",class:"w-6 h-6 text-white"})])]),a("div",Ee,[a("h4",Re,w((r=l.flow)==null?void 0:r.name),1),a("p",$e,w((s=l.flow)==null?void 0:s.description),1),a("div",Ie,[a("span",Be,[b(u(v),{icon:"lucide:user",class:"w-4 h-4"}),j(" "+w((M=(C=(d=l.flow)==null?void 0:d.publicMetadata)==null?void 0:C.author)==null?void 0:M.name),1)]),a("span",Ce,[b(u(v),{icon:"lucide:download",class:"w-4 h-4"}),j(" "+w(((L=(R=l.flow)==null?void 0:R.publicStats)==null?void 0:L.imports)||0)+" imports ",1)]),a("span",Me,[b(u(v),{icon:"lucide:star",class:"w-4 h-4 text-yellow-500"}),j(" "+w(((O=(N=(D=l.flow)==null?void 0:D.publicStats)==null?void 0:N.averageRating)==null?void 0:O.toFixed(1))||0),1)])])])])]),a("div",Ve,[e[9]||(e[9]=a("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Escolha o tipo de importação: ",-1)),a("div",Se,[a("label",{class:U(["flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-brand-purple/50 transition-colors",n.value==="import"?"border-brand-purple bg-brand-purple/5":"border-gray-200"])},[se(a("input",{"onUpdate:modelValue":e[0]||(e[0]=T=>n.value=T),type:"radio",value:"import",class:"mt-1 w-5 h-5 text-brand-purple accent-brand-purple"},null,512),[[te,n.value]]),a("div",je,[a("div",ze,[b(u(v),{icon:"lucide:download",class:"w-5 h-5 text-brand-purple"}),e[4]||(e[4]=a("p",{class:"font-medium text-gray-900"},"Importar (recomendado)",-1))]),e[5]||(e[5]=a("p",{class:"text-sm text-gray-600"}," Cria uma cópia independente do flow. Você não receberá atualizações do original. ",-1))])],2),(q=(A=l.flow)==null?void 0:A.publicMetadata)!=null&&q.allowForking?(k(),x("label",{key:0,class:U(["flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-brand-pink/50 transition-colors",n.value==="fork"?"border-brand-pink bg-brand-pink/5":"border-gray-200"])},[se(a("input",{"onUpdate:modelValue":e[1]||(e[1]=T=>n.value=T),type:"radio",value:"fork",class:"mt-1 w-5 h-5 text-brand-pink accent-brand-pink"},null,512),[[te,n.value]]),a("div",Le,[a("div",Pe,[b(u(v),{icon:"lucide:git-fork",class:"w-5 h-5 text-brand-pink"}),e[6]||(e[6]=a("p",{class:"font-medium text-gray-900"},"Fork",-1))]),e[7]||(e[7]=a("p",{class:"text-sm text-gray-600"}," Cria um fork mantendo referência ao original. Você será notificado de atualizações. ",-1))])],2)):S("",!0),(K=(H=l.flow)==null?void 0:H.publicMetadata)!=null&&K.allowForking?S("",!0):(k(),x("div",Te,[a("p",Ue,[b(u(v),{icon:"lucide:info",class:"w-4 h-4"}),e[8]||(e[8]=j(" Este flow não permite forks. Apenas importação está disponível. ",-1))])]))])]),a("div",De,[a("div",Ne,[a("div",Oe,[b(u(v),{icon:"lucide:alert-triangle",class:"w-5 h-5 text-brand-orange mt-0.5 mr-2 flex-shrink-0"}),a("div",Ae,[e[12]||(e[12]=a("p",{class:"font-medium mb-1 text-brand-orange"},"Importante:",-1)),a("ul",qe,[e[10]||(e[10]=a("li",null,"Você precisará configurar suas próprias credenciais (API keys, senhas, etc.)",-1)),e[11]||(e[11]=a("li",null,"O flow importado será privado e não afetará o original",-1)),(J=(G=l.flow)==null?void 0:G.publicMetadata)!=null&&J.requireAttribution?(k(),x("li",He,"Este flow requer atribuição ao autor original")):S("",!0)])])])]),a("div",Ke,[a("div",Ge,[b(u(v),{icon:"lucide:scale",class:"w-5 h-5 text-brand-purple mt-0.5 mr-2 flex-shrink-0"}),a("div",Je,[a("p",Qe,"Licença: "+w(((W=(Q=l.flow)==null?void 0:Q.publicMetadata)==null?void 0:W.license)||"MIT"),1),a("p",null,"Este flow está licenciado sob "+w(((Y=(X=l.flow)==null?void 0:X.publicMetadata)==null?void 0:Y.license)||"MIT License")+".",1)])])])]),a("div",We,[a("button",{onClick:B,type:"button",class:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 font-medium transition-all"}," Cancelar "),a("button",{onClick:P,type:"button",disabled:u(y),class:"px-6 py-2 bg-brand-purple text-white rounded-lg hover:brightness-110 disabled:opacity-50 flex items-center gap-2 font-medium transition-all"},[b(u(v),{icon:u(y)?"lucide:loader-2":n.value==="fork"?"lucide:git-fork":"lucide:download",class:U(["w-4 h-4",{"animate-spin":u(y)}])},null,8,["icon","class"]),j(" "+w(u(y)?"Importando...":n.value==="fork"?"Criar Fork":"Importar Flow"),1)],8,Xe)])]))])])])):S("",!0)}}};export{aa as _,ie as u};
