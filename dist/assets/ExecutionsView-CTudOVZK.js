var H=Object.defineProperty;var V=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var M=(u,i,r)=>i in u?H(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,A=(u,i)=>{for(var r in i||(i={}))R.call(i,r)&&M(u,r,i[r]);if(V)for(var r of V(i))J.call(i,r)&&M(u,r,i[r]);return u};var w=(u,i,r)=>new Promise((D,v)=>{var F=a=>{try{x(r.next(a))}catch(o){v(o)}},p=a=>{try{x(r.throw(a))}catch(o){v(o)}},x=a=>a.done?D(a.value):Promise.resolve(a.value).then(F,p);x((r=r.apply(u,i)).next())});import{r as k,o as K,c as Q,a as W,q as X,z as Y,b as d,i as e,p as _,h as c,F as S,C as B,t as n,G as N,v as T,k as C,l as b,u as g,I as m,n as Z,m as ee}from"./vue-vendor-Cs4IDGu-.js";import{A as te}from"./AppLayout-jrBjamem.js";import{_ as se}from"./ExecutionStatusBadge-BtYUDsGU.js";import{u as ae}from"./useFlows-D_qEO5GI.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useAuth-C1_85XZE.js";import"./utils-nSMfNdYQ.js";const oe={class:"glass-card backdrop-blur-xl bg-white/30 rounded-lg border border-white/20 p-6 mb-6"},re={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ie=["value"],ne={class:"flex items-center space-x-3 mt-4"},de={class:"glass-card backdrop-blur-xl bg-white/30 rounded-lg border border-white/20 overflow-hidden"},ue={key:0,class:"flex justify-center py-12"},ce={key:1,class:"text-center py-12"},pe={class:"text-gray-600 text-sm tracking-wide"},xe={key:2,class:"p-4"},be={class:"w-full border-separate border-spacing-y-2 table-fixed"},ge=["onClick"],me={class:"px-4 py-4 rounded-l-lg"},fe={class:"flex items-center min-w-0"},ve={class:"min-w-0"},ye={class:"text-sm font-medium text-gray-900 truncate"},he={key:0,class:"text-xs text-brand-red"},we={class:"px-4 py-4"},ke={class:"px-4 py-4 hidden md:table-cell"},_e={class:"px-4 py-4 text-sm text-gray-700 hidden lg:table-cell"},De={class:"truncate"},Fe={class:"px-4 py-4 text-sm text-gray-700 hidden xl:table-cell"},Ce={class:"px-4 py-4 text-sm text-gray-700 hidden xl:table-cell"},Ee={class:"px-4 py-4 text-right text-sm font-medium rounded-r-lg"},$e=["onClick"],Ie={key:3,class:"px-6 py-4 border-t border-gray-200/30 bg-white/10 backdrop-blur-sm"},Ve={class:"flex items-center justify-between"},Me={class:"text-sm text-gray-700 tracking-wide"},Ae={class:"flex items-center space-x-2"},Se=["disabled"],Be={class:"text-sm text-gray-700 tracking-wide"},Ne=["disabled"],Te={__name:"ExecutionsView",setup(u){const i=Y(),r=ae(),{getExecutions:D,loading:v,getFlowOptions:F,flowOptions:p}=r,x=k([]),a=k({page:1,limit:10,total:0,pages:0}),o=k({flowId:"",status:"",startDate:"",endDate:""}),y=k([]);K(()=>w(null,null,function*(){yield h(),yield L()}));function h(){return w(this,null,function*(){const l=A({page:a.value.page,limit:a.value.limit},o.value);Object.keys(l).forEach(s=>{(l[s]===""||l[s]===null)&&delete l[s]});const t=yield D(l);t.success&&(x.value=t.data||[],t.pagination&&(a.value=t.pagination))})}function L(){return w(this,null,function*(){try{const l=yield F();l.success?y.value=l.data.flows||p.value||[]:p.value&&(y.value=p.value)}catch(l){p.value&&(y.value=p.value)}})}function U(){a.value.page=1,h()}function j(){o.value={flowId:"",status:"",startDate:"",endDate:""},a.value.page=1,h()}function E(l){a.value.page=l,h()}function $(l){i.push(`/executions/${l._id}`)}function O(l){return new Date(l).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function P(l){if(!l)return"-";const t=Math.floor(l/1e3),s=Math.floor(t/60),f=Math.floor(s/60);return f>0?`${f}h ${s%60}m ${t%60}s`:s>0?`${s}m ${t%60}s`:`${t}s`}function z(l){return{manual:"Manual",api:"API",schedule:"Agendado"}[l]||l}function q(l){return{manual:"bg-brand-pink/20 text-brand-pink border-brand-pink/30",api:"bg-brand-purple/20 text-brand-purple border-brand-purple/30",schedule:"bg-brand-orange/20 text-brand-orange border-brand-orange/30"}[l]||"bg-gray-100/50 text-gray-700 border-gray-300"}const I=Q(()=>o.value.flowId||o.value.status||o.value.startDate||o.value.endDate);return(l,t)=>(d(),W(te,null,{default:X(()=>[t[17]||(t[17]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-semibold text-gray-800 tracking-wide"},"Histórico de Execuções"),e("p",{class:"text-gray-600 mt-2 text-sm tracking-wide"},"Visualize e analise o histórico de execução dos seus fluxos")],-1)),e("div",oe,[e("div",re,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wider"},"Fluxo",-1)),_(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.flowId=s),class:"w-full px-3 py-2.5 bg-white/50 backdrop-blur-sm border border-gray-300 rounded text-gray-900 focus:outline-none focus:border-brand-purple focus:bg-white/70 transition-all text-sm"},[t[6]||(t[6]=e("option",{value:""},"Todos os Fluxos",-1)),(d(!0),c(S,null,B(y.value,s=>(d(),c("option",{key:s.id||s._id,value:s.id||s._id},n(s.name),9,ie))),128))],512),[[N,o.value.flowId]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wider"},"Status",-1)),_(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.status=s),class:"w-full px-3 py-2.5 bg-white/50 backdrop-blur-sm border border-gray-300 rounded text-gray-900 focus:outline-none focus:border-brand-purple focus:bg-white/70 transition-all text-sm"},[...t[8]||(t[8]=[e("option",{value:""},"Todos os Status",-1),e("option",{value:"success"},"Sucesso",-1),e("option",{value:"failed"},"Falhou",-1),e("option",{value:"running"},"Executando",-1)])],512),[[N,o.value.status]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wider"},"Data Inicial",-1)),_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.startDate=s),type:"date",class:"w-full px-3 py-2.5 bg-white/50 backdrop-blur-sm border border-gray-300 rounded text-gray-900 focus:outline-none focus:border-brand-purple focus:bg-white/70 transition-all text-sm"},null,512),[[T,o.value.startDate]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wider"},"Data Final",-1)),_(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.endDate=s),type:"date",class:"w-full px-3 py-2.5 bg-white/50 backdrop-blur-sm border border-gray-300 rounded text-gray-900 focus:outline-none focus:border-brand-purple focus:bg-white/70 transition-all text-sm"},null,512),[[T,o.value.endDate]])])]),e("div",ne,[e("button",{onClick:U,class:"bg-brand-purple hover:brightness-110 text-white px-4 py-2.5 rounded flex items-center space-x-2 transition-all text-sm font-medium tracking-wide"},[b(g(m),{icon:"lucide:filter",class:"w-4 h-4"}),t[12]||(t[12]=e("span",null,"Aplicar Filtros",-1))]),I.value?(d(),c("button",{key:0,onClick:j,class:"bg-white/50 backdrop-blur-sm border border-gray-300 text-gray-700 px-4 py-2.5 rounded hover:bg-white/70 hover:brightness-95 transition-all flex items-center space-x-2 text-sm font-medium tracking-wide"},[b(g(m),{icon:"lucide:x",class:"w-4 h-4"}),t[13]||(t[13]=e("span",null,"Limpar",-1))])):C("",!0)])]),e("div",de,[g(v)?(d(),c("div",ue,[b(g(m),{icon:"lucide:loader-2",class:"w-8 h-8 animate-spin text-brand-purple"})])):x.value.length===0?(d(),c("div",ce,[b(g(m),{icon:"lucide:inbox",class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t[14]||(t[14]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"Nenhuma execução encontrada",-1)),e("p",pe,n(I.value?"Tente ajustar seus filtros":"Execute um fluxo para ver resultados aqui"),1)])):(d(),c("div",xe,[e("table",be,[t[16]||(t[16]=e("thead",null,[e("tr",null,[e("th",{class:"w-[25%] px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider"},"Fluxo"),e("th",{class:"w-[12%] px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider"},"Status"),e("th",{class:"w-[13%] px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider hidden md:table-cell"},"Origem"),e("th",{class:"w-[18%] px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider hidden lg:table-cell"},"Iniciado"),e("th",{class:"w-[12%] px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider hidden xl:table-cell"},"Duração"),e("th",{class:"w-[10%] px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider hidden xl:table-cell"},"Nós"),e("th",{class:"w-[10%] px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider"},"Ações")])],-1)),e("tbody",null,[(d(!0),c(S,null,B(x.value,s=>{var f;return d(),c("tr",{key:s._id,class:"bg-white/20 backdrop-blur-sm border border-white/30 hover:bg-white/30 hover:shadow-md cursor-pointer transition-all rounded-lg",onClick:G=>$(s)},[e("td",me,[e("div",fe,[b(g(m),{icon:"lucide:workflow",class:"w-4 h-4 text-brand-purple mr-2 flex-shrink-0"}),e("div",ve,[e("div",ye,n(s.flowName||"Fluxo sem nome"),1),s.flowDeleted?(d(),c("div",he," Excluído ")):C("",!0)])])]),e("td",we,[b(se,{status:s.status},null,8,["status"])]),e("td",ke,[e("span",{class:Z([q(s.triggeredBy),"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium border backdrop-blur-sm"])},n(z(s.triggeredBy)),3)]),e("td",_e,[e("div",De,n(O(s.startedAt)),1)]),e("td",Fe,n(P(s.executionTime)),1),e("td",Ce,n(s.nodesExecuted||0)+"/"+n(((f=s.flowSnapshot)==null?void 0:f.totalNodes)||0),1),e("td",Ee,[e("button",{onClick:ee(G=>$(s),["stop"]),class:"text-brand-purple hover:text-brand-purple/80 transition-colors"},[t[15]||(t[15]=e("span",{class:"hidden sm:inline"},"Ver Detalhes",-1)),b(g(m),{icon:"lucide:eye",class:"w-4 h-4 inline sm:hidden"})],8,$e)])],8,ge)}),128))])])])),a.value.pages>1?(d(),c("div",Ie,[e("div",Ve,[e("div",Me," Mostrando "+n((a.value.page-1)*a.value.limit+1)+" a "+n(Math.min(a.value.page*a.value.limit,a.value.total))+" de "+n(a.value.total)+" resultados ",1),e("div",Ae,[e("button",{onClick:t[4]||(t[4]=s=>E(a.value.page-1)),disabled:a.value.page===1,class:"px-3 py-2 bg-white/50 backdrop-blur-sm border border-gray-300 rounded hover:bg-white/70 hover:brightness-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium text-gray-700"}," Anterior ",8,Se),e("span",Be," Página "+n(a.value.page)+" de "+n(a.value.pages),1),e("button",{onClick:t[5]||(t[5]=s=>E(a.value.page+1)),disabled:a.value.page===a.value.pages,class:"px-3 py-2 bg-white/50 backdrop-blur-sm border border-gray-300 rounded hover:bg-white/70 hover:brightness-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium text-gray-700"}," Próximo ",8,Ne)])])])):C("",!0)])]),_:1}))}},He=le(Te,[["__scopeId","data-v-c1671ae9"]]);export{He as default};
