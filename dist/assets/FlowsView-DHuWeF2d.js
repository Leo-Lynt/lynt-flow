var C=(b,k,f)=>new Promise((_,m)=>{var w=d=>{try{y(f.next(d))}catch(l){m(l)}},E=d=>{try{y(f.throw(d))}catch(l){m(l)}},y=d=>d.done?_(d.value):Promise.resolve(d.value).then(w,E);y((f=f.apply(b,k)).next())});import{r as v,w as ee,h as u,k as F,b as c,i as e,l as i,u as n,I as r,t as h,F as P,C as R,p as T,y as V,x as te,E as se,n as Q,m as $,c as oe,o as ae,a as z,q as le,z as ne,v as ie}from"./vue-vendor-Cs4IDGu-.js";import{A as re}from"./AppLayout-jrBjamem.js";import{u as de}from"./useFlows-D_qEO5GI.js";import{u as ce}from"./useAuth-C1_85XZE.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-nSMfNdYQ.js";const xe={class:"flex items-center justify-between p-6 border-b border-gray-200"},me={class:"flex items-center space-x-3"},pe={class:"text-sm text-gray-600"},be=["disabled"],ge={class:"flex-1 overflow-y-auto p-6"},he={key:0,class:"text-center py-8"},fe={key:1,class:"space-y-4"},ve={class:"block"},we={class:"flex items-center justify-between mb-1"},ye={class:"text-sm font-medium text-gray-700"},ke={key:0,class:"text-red-500"},_e={class:"text-xs text-gray-500"},Ce=["onUpdate:modelValue","type","required","placeholder"],$e={key:1,class:"flex items-center"},Fe=["onUpdate:modelValue","id"],Ee=["for"],De={key:2,class:"text-xs text-gray-500 mt-1"},Ve={key:3,class:"text-xs text-gray-400 mt-1"},je={class:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200"},Ie=["disabled"],Le=["disabled"],Ne={__name:"FlowExecutionModal",props:{show:{type:Boolean,default:!1},flowName:{type:String,required:!0},inputs:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["close","execute"],setup(b,{emit:k}){const f=b,_=k,m=v({});ee(()=>f.inputs,d=>{if(d&&d.length>0){const l={};d.forEach(o=>{l[o.name]=o.defaultValue!==void 0?o.defaultValue:""}),m.value=l}},{immediate:!0});function w(){f.loading||_("close")}function E(){const d=f.inputs.filter(l=>l.required&&!m.value[l.name]).map(l=>l.name);if(d.length>0){alert(`Por favor, preencha os campos obrigatórios: ${d.join(", ")}`);return}_("execute",m.value)}function y(d){return{string:"text",number:"number",boolean:"checkbox",email:"email",url:"url"}[d]||"text"}return(d,l)=>b.show?(c(),u("div",{key:0,class:"fixed inset-0 bg-gray-900/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:w},[e("div",{class:"bg-white rounded-lg shadow-2xl max-w-2xl w-full max-h-[90vh] flex flex-col",onClick:l[0]||(l[0]=$(()=>{},["stop"]))},[e("div",xe,[e("div",me,[i(n(r),{icon:"lucide:play-circle",class:"w-6 h-6 text-brand-purple"}),e("div",null,[l[1]||(l[1]=e("h3",{class:"text-lg font-semibold text-gray-900 tracking-wide"},"Executar Fluxo",-1)),e("p",pe,h(b.flowName),1)])]),e("button",{onClick:w,disabled:b.loading,class:"text-gray-500 hover:text-gray-700 hover:bg-gray-100 p-1 rounded transition-all disabled:opacity-50"},[i(n(r),{icon:"lucide:x",class:"w-5 h-5"})],8,be)]),e("div",ge,[b.inputs.length===0?(c(),u("div",he,[i(n(r),{icon:"lucide:info",class:"w-12 h-12 text-gray-400 mx-auto mb-3"}),l[2]||(l[2]=e("p",{class:"text-gray-600 tracking-wide"},"Este fluxo não requer entradas",-1))])):(c(),u("div",fe,[(c(!0),u(P,null,R(b.inputs,o=>(c(),u("div",{key:o.name,class:"space-y-2"},[e("label",ve,[e("div",we,[e("span",ye,[V(h(o.name)+" ",1),o.required?(c(),u("span",ke,"*")):F("",!0)]),e("span",_e,h(o.type),1)]),o.type!=="boolean"?T((c(),u("input",{key:0,"onUpdate:modelValue":g=>m.value[o.name]=g,type:y(o.type),required:o.required,placeholder:o.defaultValue!==void 0?String(o.defaultValue):"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-purple focus:border-transparent focus:border-transparent"},null,8,Ce)),[[te,m.value[o.name]]]):(c(),u("div",$e,[T(e("input",{"onUpdate:modelValue":g=>m.value[o.name]=g,type:"checkbox",id:`input-${o.name}`,class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-brand-purple focus:border-transparent"},null,8,Fe),[[se,m.value[o.name]]]),e("label",{for:`input-${o.name}`,class:"ml-2 text-sm text-gray-700"},h(o.description||"Enable"),9,Ee)])),o.description&&o.type!=="boolean"?(c(),u("p",De,h(o.description),1)):F("",!0),o.nodeName?(c(),u("p",Ve,[i(n(r),{icon:"lucide:box",class:"w-3 h-3 inline mr-1"}),V(" From: "+h(o.nodeName),1)])):F("",!0)])]))),128))]))]),e("div",je,[e("button",{onClick:w,disabled:b.loading,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all disabled:opacity-50 font-medium tracking-wide"}," Cancelar ",8,Ie),e("button",{onClick:E,disabled:b.loading,class:"px-4 py-2 bg-brand-purple text-white rounded-lg hover:brightness-110 transition-all disabled:opacity-50 flex items-center space-x-2 font-medium tracking-wide"},[i(n(r),{icon:b.loading?"lucide:loader-2":"lucide:play",class:Q(["w-4 h-4",{"animate-spin":b.loading}])},null,8,["icon","class"]),e("span",null,h(b.loading?"Executando...":"Executar Fluxo"),1)],8,Le)])])])):F("",!0)}},Me={class:"mb-8"},qe={class:"flex items-center justify-between"},Se={class:"mb-6"},Te={class:"relative max-w-md"},Ae={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},Be={key:0,class:"flex justify-center py-12"},Ue={key:1,class:"text-center py-12 glass-card backdrop-blur-xl bg-white/30 rounded-lg border border-white/20"},ze={key:2,class:"text-center py-12 glass-card backdrop-blur-xl bg-white/30 rounded-lg border border-white/20"},Pe={key:3,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},Re=["onClick"],Qe={class:"p-4 border-b border-gray-200/30"},We={class:"mb-2 flex items-center justify-between"},Ge={class:"text-base font-semibold text-gray-900 group-hover:text-brand-purple transition-colors tracking-wide"},He={class:"text-xs text-gray-600 line-clamp-2 min-h-[2.5rem] tracking-wide"},Je={class:"px-4 py-3 bg-white/20 backdrop-blur-sm text-xs text-gray-600 space-y-1.5"},Ke={class:"flex items-center justify-between"},Oe={class:"flex items-center"},Xe={class:"flex items-center"},Ye={class:"flex items-center"},Ze={class:"p-3 bg-white/10 backdrop-blur-sm border-t border-gray-200/30"},et={class:"flex items-center justify-between"},tt={class:"flex items-center space-x-1"},st=["onClick","disabled"],ot=["onClick"],at=["onClick"],lt=["onClick"],nt={class:"flex items-center mb-4"},it={class:"text-gray-700 mb-6 text-sm tracking-wide"},rt={class:"flex space-x-3"},dt={__name:"FlowsView",setup(b){const k=ne();ce();const{flows:f,loading:_,getFlows:m,deleteFlow:w,cloneFlow:E,executeFlow:y,getFlowInputs:d}=de(),l=v(!1),o=v(null),g=v(""),N=v(new Set),j=v(!1),D=v(null),M=v([]),I=v(!1),q=oe(()=>g.value.trim()?f.value.filter(s=>{var t,p,x;return s.name.toLowerCase().includes(g.value.toLowerCase())||((t=s.description)==null?void 0:t.toLowerCase().includes(g.value.toLowerCase()))||((p=s.category)==null?void 0:p.toLowerCase().includes(g.value.toLowerCase()))||((x=s.tags)==null?void 0:x.some(a=>a.toLowerCase().includes(g.value.toLowerCase())))}):f.value);ae(()=>C(null,null,function*(){yield m({page:1,limit:100})}));function A(){k.push("/flows/create")}function W(s){const t=s.id||s._id;if(!t){alert("Error: Flow ID is missing.");return}k.push(`/flows/${t}/edit`)}function G(s){return C(this,null,function*(){const t=s._id||s.id;(yield E(t)).success&&(yield m({page:1,limit:100}))})}function H(s){o.value=s,l.value=!0}function J(){return C(this,null,function*(){if(!o.value)return;const s=o.value._id||o.value.id;(yield w(s)).success&&(l.value=!1,o.value=null,yield m({page:1,limit:100}))})}function K(s){const t=localStorage.getItem("accessToken"),p=s._id||s.id;if(!t)return;const x=`http://localhost:5174/editor/?flowId=${p}`;window.open(x,"_blank")}function O(s){return C(this,null,function*(){var a;const t=s._id||s.id,p=yield d(t);if(!p.success){alert(`Erro ao buscar inputs: ${p.error}`);return}const x=((a=p.data.data)==null?void 0:a.inputs)||[];x.length>0?(D.value=s,M.value=x,j.value=!0):yield B(t)})}function B(p){return C(this,arguments,function*(s,t={}){N.value.add(s),I.value=!0;const x=yield y(s,t);N.value.delete(s),I.value=!1,x.success?(j.value=!1,alert("Flow executado com sucesso!"),yield m({page:1,limit:100})):alert(`Erro ao executar flow: ${x.error}`)})}function X(s){var p,x;const t=((p=D.value)==null?void 0:p._id)||((x=D.value)==null?void 0:x.id);t&&B(t,s)}function Y(){I.value||(j.value=!1,D.value=null,M.value=[])}function S(s){const t=s._id||s.id;return N.value.has(t)}function Z(s){return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}return(s,t)=>(c(),z(re,null,{default:le(()=>{var p,x;return[e("div",Me,[e("div",qe,[t[6]||(t[6]=e("div",null,[e("h1",{class:"text-3xl font-semibold text-gray-800 tracking-wide"},"Fluxos"),e("p",{class:"text-gray-600 mt-2 text-sm tracking-wide"},"Crie e gerencie seus fluxos de automação")],-1)),e("button",{onClick:A,class:"bg-brand-purple hover:brightness-110 text-white px-5 py-2.5 rounded flex items-center space-x-2 transition-all shadow-sm hover:shadow-lg text-sm font-medium tracking-wide"},[i(n(r),{icon:"lucide:plus",class:"w-4 h-4"}),t[5]||(t[5]=e("span",null,"Criar Novo Fluxo",-1))])])]),e("div",Se,[e("div",Te,[e("div",Ae,[i(n(r),{icon:"lucide:search",class:"w-5 h-5 text-gray-400"})]),T(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>g.value=a),type:"text",placeholder:"Buscar fluxos por nome, descrição, categoria ou tags...",class:"block w-full pl-10 pr-3 py-2.5 bg-white/50 backdrop-blur-sm border border-gray-300 rounded text-gray-900 placeholder-gray-400 focus:outline-none focus:border-brand-purple focus:bg-white/70 transition-all text-sm tracking-wide"},null,512),[[ie,g.value]])])]),n(_)?(c(),u("div",Be,[i(n(r),{icon:"lucide:loader-2",class:"w-8 h-8 animate-spin text-brand-purple"})])):q.value.length===0&&!g.value.trim()?(c(),u("div",Ue,[i(n(r),{icon:"lucide:workflow",class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t[8]||(t[8]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"Nenhum fluxo encontrado",-1)),t[9]||(t[9]=e("p",{class:"text-gray-600 mb-6 text-sm tracking-wide"}," Crie seu primeiro fluxo para começar ",-1)),e("button",{onClick:A,class:"bg-brand-purple hover:brightness-110 text-white px-5 py-2.5 rounded transition-all inline-flex items-center space-x-2 text-sm font-medium tracking-wide"},[i(n(r),{icon:"lucide:plus",class:"w-4 h-4"}),t[7]||(t[7]=e("span",null,"Criar Primeiro Fluxo",-1))])])):q.value.length===0&&g.value.trim()?(c(),u("div",ze,[i(n(r),{icon:"lucide:search",class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t[10]||(t[10]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"Nenhum fluxo encontrado",-1)),t[11]||(t[11]=e("p",{class:"text-gray-600 mb-6 text-sm tracking-wide"}," Nenhum fluxo corresponde aos seus critérios de busca. Tente ajustar os termos. ",-1)),e("button",{onClick:t[1]||(t[1]=a=>g.value=""),class:"text-brand-purple hover:text-brand-purple/80 text-sm font-medium transition-colors underline decoration-brand-purple/30 hover:decoration-brand-purple/60 underline-offset-2"}," Limpar busca ")])):(c(),u("div",Pe,[(c(!0),u(P,null,R(q.value,a=>{var U;return c(),u("div",{key:a._id||a.id,onClick:L=>K(a),class:"glass-card backdrop-blur-xl bg-white/30 rounded-lg border border-white/20 hover:shadow-xl hover:bg-white/40 transition-all duration-200 overflow-hidden group cursor-pointer"},[e("div",Qe,[e("div",We,[e("h3",Ge,h(a.name),1),a.isPublic?(c(),z(n(r),{key:0,icon:"lucide:globe",class:"w-4 h-4 text-brand-green flex-shrink-0",title:"Fluxo público"})):F("",!0)]),e("p",He,h(a.description||"Sem descrição disponível"),1)]),e("div",Je,[e("div",Ke,[e("span",Oe,[i(n(r),{icon:"lucide:git-branch",class:"w-3 h-3 mr-1.5 text-brand-purple"}),V(" "+h(a.totalNodes||0)+" nós ",1)]),e("span",Xe,[i(n(r),{icon:"lucide:play",class:"w-3 h-3 mr-1.5 text-brand-green"}),V(" "+h(((U=a.executionStats)==null?void 0:U.totalExecutions)||0)+" execuções ",1)])]),e("div",Ye,[i(n(r),{icon:"lucide:clock",class:"w-3 h-3 mr-1.5 text-brand-orange"}),V(" Atualizado "+h(Z(a.updatedAt||a.createdAt)),1)])]),e("div",Ze,[e("div",et,[e("div",tt,[e("button",{onClick:$(L=>O(a),["stop"]),disabled:S(a),class:"p-1.5 text-brand-green hover:bg-white/30 rounded transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:"Executar Fluxo"},[i(n(r),{icon:S(a)?"lucide:loader-2":"lucide:play",class:Q(["w-4 h-4",{"animate-spin":S(a)}])},null,8,["icon","class"])],8,st),e("button",{onClick:$(L=>W(a),["stop"]),class:"p-1.5 text-brand-purple hover:bg-white/30 rounded transition-all",title:"Editar"},[i(n(r),{icon:"lucide:edit",class:"w-4 h-4"})],8,ot),e("button",{onClick:$(L=>G(a),["stop"]),class:"p-1.5 text-brand-pink hover:bg-white/30 rounded transition-all",title:"Duplicar"},[i(n(r),{icon:"lucide:copy",class:"w-4 h-4"})],8,at)]),e("button",{onClick:$(L=>H(a),["stop"]),class:"p-1.5 text-brand-red hover:bg-white/30 rounded transition-all",title:"Excluir"},[i(n(r),{icon:"lucide:trash-2",class:"w-4 h-4"})],8,lt)])])],8,Re)}),128))])),i(Ne,{show:j.value,"flow-name":((p=D.value)==null?void 0:p.name)||"",inputs:M.value,loading:I.value,onClose:Y,onExecute:X},null,8,["show","flow-name","inputs","loading"]),l.value?(c(),u("div",{key:4,class:"fixed inset-0 bg-gray-900/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:t[4]||(t[4]=a=>l.value=!1)},[e("div",{class:"glass-card backdrop-blur-xl bg-white/30 rounded-lg border border-white/20 p-6 max-w-sm w-full mx-4",onClick:t[3]||(t[3]=$(()=>{},["stop"]))},[e("div",nt,[i(n(r),{icon:"lucide:alert-triangle",class:"w-6 h-6 text-brand-red mr-3"}),t[12]||(t[12]=e("h3",{class:"text-lg font-semibold text-gray-900 tracking-wide"},"Excluir Fluxo",-1))]),e("p",it,' Tem certeza que deseja excluir "'+h((x=o.value)==null?void 0:x.name)+'"? Esta ação não pode ser desfeita. ',1),e("div",rt,[e("button",{onClick:t[2]||(t[2]=a=>l.value=!1),class:"flex-1 px-4 py-2.5 bg-white/50 backdrop-blur-sm border border-gray-300 text-gray-700 rounded hover:bg-white/70 hover:brightness-95 transition-all text-sm font-medium tracking-wide"}," Cancelar "),e("button",{onClick:J,class:"flex-1 px-4 py-2.5 bg-brand-red text-white rounded hover:brightness-110 transition-all text-sm font-medium tracking-wide"}," Excluir ")])])])):F("",!0)]}),_:1}))}},ht=ue(dt,[["__scopeId","data-v-e209f102"]]);export{ht as default};
