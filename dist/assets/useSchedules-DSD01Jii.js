var f=(u,d,r)=>new Promise((l,y)=>{var x=o=>{try{m(r.next(o))}catch(g){y(g)}},S=o=>{try{m(r.throw(o))}catch(g){y(g)}},m=o=>o.done?l(o.value):Promise.resolve(o.value).then(x,S);m((r=r.apply(u,d)).next())});import{c as v,h as U,b as B,l as R,y as $,n as k,u as A,I as O,t as V,r as b}from"./vue-vendor-Cs4IDGu-.js";import{a as h}from"./useAuth-C1_85XZE.js";const D=["title"],W={__name:"ScheduleStatusBadge",props:{enabled:{type:Boolean,required:!0},isCurrentlyRunning:{type:Boolean,default:!1},pausedReason:{type:String,default:null}},setup(u){const d=u,r=v(()=>d.isCurrentlyRunning?{class:"bg-blue-100 text-blue-800 border-blue-200",icon:"lucide:loader-2",label:"Running",animate:!0}:d.enabled?{class:"bg-green-100 text-green-800 border-green-200",icon:"lucide:check-circle",label:"Active",animate:!1}:{class:"bg-gray-100 text-gray-800 border-gray-200",icon:"lucide:pause-circle",label:"Paused",animate:!1});return(l,y)=>(B(),U("span",{class:k([r.value.class,"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border"]),title:u.pausedReason||void 0},[R(A(O),{icon:r.value.icon,class:k(["w-3 h-3 mr-1",{"animate-spin":r.value.animate}])},null,8,["icon","class"]),$(" "+V(r.value.label),1)],10,D))}};function q(){const u=b([]),d=b(null),r=b(!1),l=b(null);function y(){return f(this,arguments,function*(e={}){var a,t,n;try{r.value=!0,l.value=null;const s=yield h.get("/schedules",{params:e});return u.value=s.data.data||[],{success:!0,data:s.data.data,pagination:s.data.pagination}}catch(s){return l.value=((n=(t=(a=s.response)==null?void 0:a.data)==null?void 0:t.error)==null?void 0:n.message)||"Error fetching schedules",{success:!1,error:l.value}}finally{r.value=!1}})}function x(e){return f(this,null,function*(){var a,t,n;try{r.value=!0,l.value=null;const s=yield h.get(`/schedules/${e}`);return d.value=s.data.data,{success:!0,data:s.data.data}}catch(s){return l.value=((n=(t=(a=s.response)==null?void 0:a.data)==null?void 0:t.error)==null?void 0:n.message)||"Error fetching schedule",{success:!1,error:l.value}}finally{r.value=!1}})}function S(e){return f(this,null,function*(){var a,t,n;try{r.value=!0,l.value=null;const s=w(e),i=(yield h.post("/schedules",s)).data.data;return u.value.unshift(i),{success:!0,data:i}}catch(s){return l.value=((n=(t=(a=s.response)==null?void 0:a.data)==null?void 0:t.error)==null?void 0:n.message)||"Error creating schedule",{success:!1,error:l.value}}finally{r.value=!1}})}function m(e,a){return f(this,null,function*(){var t,n,s;try{r.value=!0,l.value=null;const c=w(a),p=(yield h.put(`/schedules/${e}`,c)).data.data,E=u.value.findIndex(I=>I._id===e);return E!==-1&&(u.value[E]=p),d.value=p,{success:!0,data:p}}catch(c){return l.value=((s=(n=(t=c.response)==null?void 0:t.data)==null?void 0:n.error)==null?void 0:s.message)||"Error updating schedule",{success:!1,error:l.value}}finally{r.value=!1}})}function o(e){return f(this,null,function*(){var a,t,n;try{return r.value=!0,l.value=null,yield h.delete(`/schedules/${e}`),u.value=u.value.filter(s=>s._id!==e),{success:!0}}catch(s){return l.value=((n=(t=(a=s.response)==null?void 0:a.data)==null?void 0:t.error)==null?void 0:n.message)||"Error deleting schedule",{success:!1,error:l.value}}finally{r.value=!1}})}function g(e){return f(this,null,function*(){var a,t,n;try{r.value=!0,l.value=null;const c=(yield h.post(`/schedules/${e}/enable`)).data.data,i=u.value.findIndex(p=>p._id===e);return i!==-1&&(u.value[i]=c),{success:!0,data:c}}catch(s){return l.value=((n=(t=(a=s.response)==null?void 0:a.data)==null?void 0:t.error)==null?void 0:n.message)||"Error enabling schedule",{success:!1,error:l.value}}finally{r.value=!1}})}function _(e){return f(this,null,function*(){var a,t,n;try{r.value=!0,l.value=null;const c=(yield h.post(`/schedules/${e}/disable`)).data.data,i=u.value.findIndex(p=>p._id===e);return i!==-1&&(u.value[i]=c),{success:!0,data:c}}catch(s){return l.value=((n=(t=(a=s.response)==null?void 0:a.data)==null?void 0:t.error)==null?void 0:n.message)||"Error disabling schedule",{success:!1,error:l.value}}finally{r.value=!1}})}function w(e){const a={flowId:e.flowId,scheduleType:e.scheduleType,inputData:e.inputData||{}};switch(e.maxExecutions&&(a.maxExecutions=e.maxExecutions),e.expiresAt&&(a.expiresAt=e.expiresAt),e.scheduleType){case"interval":a.intervalValue=e.intervalValue,a.intervalUnit=e.intervalUnit;break;case"daily":a.time=e.time,a.timezone=e.timezone||"UTC";break;case"weekly":a.daysOfWeek=e.daysOfWeek,a.time=e.time,a.timezone=e.timezone||"UTC";break;case"monthly":a.dayOfMonth=e.dayOfMonth,a.time=e.time,a.timezone=e.timezone||"UTC";break;case"cron":a.cronExpression=e.cronExpression,a.timezone=e.timezone||"UTC";break}return a}const z=v(()=>u.value.filter(e=>e.enabled)),C=v(()=>u.value.filter(e=>!e.enabled)),T=v(()=>u.value.length);return{schedules:v(()=>u.value),currentSchedule:v(()=>d.value),loading:v(()=>r.value),error:v(()=>l.value),activeSchedules:z,pausedSchedules:C,totalSchedules:T,getSchedules:y,getSchedule:x,createSchedule:S,updateSchedule:m,deleteSchedule:o,enableSchedule:g,disableSchedule:_}}export{W as _,q as u};
