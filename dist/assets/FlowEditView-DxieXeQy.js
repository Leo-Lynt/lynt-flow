var w=(P,p,m)=>new Promise((h,x)=>{var a=o=>{try{f(m.next(o))}catch(c){x(c)}},b=o=>{try{f(m.throw(o))}catch(c){x(c)}},f=o=>o.done?h(o.value):Promise.resolve(o.value).then(a,b);f((m=m.apply(P,p)).next())});import{r as g,B as q,c as U,o as J,z as M,a as R,q as j,b as d,h as u,i as t,l as n,u as l,I as i,t as k,k as A,n as K,y as F,p as v,v as C,F as I,C as T,G as L,H as $,E as G}from"./vue-vendor-Cs4IDGu-.js";import{A as H}from"./AppLayout-jrBjamem.js";import{u as Q}from"./useFlows-D_qEO5GI.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useAuth-C1_85XZE.js";import"./utils-nSMfNdYQ.js";const X={key:0,class:"flex justify-center items-center h-64"},Y={class:"text-center"},Z={key:1,class:"flex justify-center items-center h-64"},ee={class:"text-center max-w-md"},te={class:"text-gray-600 mb-4 tracking-wide"},ae={key:2},se={class:"flex items-center justify-between mb-8"},oe={class:"flex items-center space-x-3"},le=["disabled"],re={key:0,class:"bg-brand-orange/10 border border-brand-orange/30 rounded-lg p-4 mb-6"},ne={class:"flex items-center"},ie={class:"glass-card backdrop-blur-xl bg-white/30 rounded-lg border border-white/20 p-6 mb-6"},de={class:"text-lg font-semibold text-gray-900 mb-4 flex items-center tracking-wide"},ue={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},ce=["value"],pe={class:"mb-6"},me={class:"mb-6"},be={class:"flex flex-wrap gap-2 mb-2"},ge=["onClick"],fe={class:"flex gap-2"},ve={class:"border-t border-gray-200 pt-4"},xe={class:"space-y-3"},ye={class:"flex items-center"},we={key:0,class:"ml-6 p-3 bg-brand-purple/10 border border-brand-purple/30 rounded-lg"},ke={class:"text-sm text-brand-purple"},he={__name:"FlowEditView",setup(P){const p=M(),m=q(),{getFlow:h,updateFlow:x}=Q(),a=g({name:"",description:"",category:"automation",tags:[],isPublic:!1,metadata:{requirements:[]}}),b=g(""),f=[{value:"automation",label:"Automação",icon:"lucide:workflow"},{value:"data-processing",label:"Processamento de Dados",icon:"lucide:database"},{value:"api-integration",label:"Integração de API",icon:"lucide:link"},{value:"notification",label:"Notificação",icon:"lucide:bell"},{value:"transformation",label:"Transformação de Dados",icon:"lucide:shuffle"},{value:"utility",label:"Utilidade",icon:"lucide:wrench"}],o=g(!1),c=g(!0),y=g(null),V=m.params.id,_=g(null),N=U(()=>a.value.name&&a.value.name.trim()),D=U(()=>_.value?JSON.stringify(a.value)!==JSON.stringify(_.value):!1);J(()=>w(null,null,function*(){yield z()}));function z(){return w(this,null,function*(){c.value=!0,y.value=null;const r=yield h(V);if(r.success){const e=r.data;e._id||e.id,a.value={name:e.name||"",description:e.description||"",category:e.category||"automation",tags:e.tags||[],isPublic:e.isPublic||!1,metadata:e.metadata||{requirements:[]}},_.value=JSON.parse(JSON.stringify(a.value))}else y.value=r.error||"Failed to load flow. Please check if the flow exists.",setTimeout(()=>{p.push("/flows")},3e3);c.value=!1})}function E(){const r=b.value.trim();r&&!a.value.tags.includes(r)&&(a.value.tags.push(r),b.value="")}function B(){return w(this,null,function*(){if(!N.value)return;o.value=!0;const r={name:a.value.name,description:a.value.description,category:a.value.category,tags:a.value.tags,isPublic:a.value.isPublic,metadata:a.value.metadata};(yield x(V,r)).success&&p.push("/flows"),o.value=!1})}function O(){p.push("/flows")}return(r,e)=>(d(),R(H,null,{default:j(()=>[c.value?(d(),u("div",X,[t("div",Y,[n(l(i),{icon:"lucide:loader-2",class:"w-8 h-8 animate-spin text-brand-purple mx-auto mb-4"}),e[6]||(e[6]=t("p",{class:"text-gray-600 tracking-wide"},"Carregando fluxo...",-1))])])):y.value?(d(),u("div",Z,[t("div",ee,[n(l(i),{icon:"lucide:alert-circle",class:"w-16 h-16 text-brand-red mx-auto mb-4"}),e[7]||(e[7]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2 tracking-wide"},"Falha ao Carregar Fluxo",-1)),t("p",te,k(y.value),1),e[8]||(e[8]=t("p",{class:"text-sm text-gray-500 tracking-wide"},"Redirecionando para fluxos em 3 segundos...",-1)),t("button",{onClick:e[0]||(e[0]=s=>l(p).push("/flows")),class:"mt-4 px-4 py-2 bg-brand-purple text-white rounded-lg hover:brightness-110 transition-all font-medium tracking-wide"}," Voltar para Fluxos ")])])):(d(),u("div",ae,[t("div",se,[e[10]||(e[10]=t("div",null,[t("h1",{class:"text-3xl font-semibold text-gray-800 tracking-wide"},"Editar Fluxo"),t("p",{class:"text-gray-600 mt-2 tracking-wide"},"Atualize os metadados e configurações do seu fluxo")],-1)),t("div",oe,[t("button",{onClick:O,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all flex items-center space-x-2 font-medium tracking-wide"},[n(l(i),{icon:"lucide:arrow-left",class:"w-4 h-4"}),e[9]||(e[9]=t("span",null,"Cancelar",-1))]),t("button",{onClick:B,disabled:!N.value||o.value||!D.value,class:"px-6 py-2 bg-brand-purple text-white rounded-lg hover:brightness-110 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center space-x-2 shadow-sm font-medium tracking-wide"},[n(l(i),{icon:o.value?"lucide:loader-2":"lucide:save",class:K(["w-4 h-4",{"animate-spin":o.value}])},null,8,["icon","class"]),t("span",null,k(o.value?"Salvando...":"Salvar Alterações"),1)],8,le)])]),D.value?(d(),u("div",re,[t("div",ne,[n(l(i),{icon:"lucide:alert-triangle",class:"w-5 h-5 text-brand-orange mr-2"}),e[11]||(e[11]=t("span",{class:"text-sm text-brand-orange font-medium tracking-wide"},"Você tem alterações não salvas",-1))])])):A("",!0),t("div",ie,[t("h2",de,[n(l(i),{icon:"lucide:settings",class:"w-5 h-5 mr-2 text-brand-purple"}),e[12]||(e[12]=F(" Configuração do Fluxo ",-1))]),t("div",ue,[t("div",null,[e[13]||(e[13]=t("label",{for:"name",class:"block text-sm font-medium text-gray-700 mb-2"}," Nome do Fluxo * ",-1)),v(t("input",{id:"name","onUpdate:modelValue":e[1]||(e[1]=s=>a.value.name=s),type:"text",placeholder:"Digite o nome do fluxo (ex: 'Fluxo de Registro de Usuário')",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-purple focus:border-transparent"},null,512),[[C,a.value.name]])]),t("div",null,[e[14]||(e[14]=t("label",{for:"category",class:"block text-sm font-medium text-gray-700 mb-2"}," Categoria ",-1)),v(t("select",{id:"category","onUpdate:modelValue":e[2]||(e[2]=s=>a.value.category=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-purple focus:border-transparent"},[(d(),u(I,null,T(f,s=>t("option",{key:s.value,value:s.value},k(s.label),9,ce)),64))],512),[[L,a.value.category]])])]),t("div",pe,[e[15]||(e[15]=t("label",{for:"description",class:"block text-sm font-medium text-gray-700 mb-2"}," Descrição ",-1)),v(t("textarea",{id:"description","onUpdate:modelValue":e[3]||(e[3]=s=>a.value.description=s),rows:"3",placeholder:"Descreva o que este fluxo faz, seu propósito e detalhes importantes...",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-purple focus:border-transparent resize-none"},null,512),[[C,a.value.description]])]),t("div",me,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Tags ",-1)),t("div",be,[(d(!0),u(I,null,T(a.value.tags,(s,S)=>(d(),u("span",{key:S,class:"inline-flex items-center px-2 py-1 bg-brand-purple/10 text-brand-purple border border-brand-purple/30 text-xs rounded-full"},[F(k(s)+" ",1),t("button",{onClick:_e=>a.value.tags.splice(S,1),class:"ml-1 text-brand-purple hover:text-brand-purple/80"},[n(l(i),{icon:"lucide:x",class:"w-3 h-3"})],8,ge)]))),128))]),t("div",fe,[v(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>b.value=s),onKeyup:$(E,["enter"]),type:"text",placeholder:"Adicionar tags (pressione Enter)",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-purple focus:border-transparent text-sm"},null,544),[[C,b.value]]),t("button",{onClick:E,type:"button",class:"px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors"},[n(l(i),{icon:"lucide:plus",class:"w-4 h-4"})])])]),t("div",ve,[e[19]||(e[19]=t("h3",{class:"text-sm font-medium text-gray-900 mb-3"},"Opções de Publicação",-1)),t("div",xe,[t("label",ye,[v(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>a.value.isPublic=s),type:"checkbox",class:"h-4 w-4 text-brand-purple focus:ring-brand-purple focus:border-transparent border-gray-300 rounded"},null,512),[[G,a.value.isPublic]]),e[17]||(e[17]=t("span",{class:"ml-2 text-sm text-gray-700"},"Tornar este fluxo público",-1)),n(l(i),{icon:"lucide:info",class:"w-4 h-4 ml-2 text-gray-400",title:"Fluxos públicos podem ser descobertos e importados por outros usuários"})]),a.value.isPublic?(d(),u("div",we,[t("p",ke,[n(l(i),{icon:"lucide:info",class:"w-4 h-4 inline mr-1"}),e[18]||(e[18]=F(" Este fluxo será publicado na biblioteca pública e ficará visível para todos os usuários. Uma varredura de segurança será realizada automaticamente. ",-1))])])):A("",!0)])])])]))]),_:1}))}},Se=W(he,[["__scopeId","data-v-9b0fb7dc"]]);export{Se as default};
