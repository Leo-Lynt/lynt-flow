import{u as y}from"./dataUtils-XrCV_Bny.js";import{g as N}from"./pathUtils-D1qRpIzi.js";import"./index-vfrSo85q.js";function h(t,e="iso"){if(!t)return null;try{switch(e){case"iso":case"iso-datetime":const i=new Date(t);return isNaN(i.getTime())?null:i;case"br":if(typeof t!="string")return null;const c=t.split("/");if(c.length!==3)return null;const[n,a,m]=c,r=new Date(`${m}-${a.padStart(2,"0")}-${n.padStart(2,"0")}`);return isNaN(r.getTime())?null:r;case"us":if(typeof t!="string")return null;const s=t.split("/");if(s.length!==3)return null;const[l,u,o]=s,f=new Date(`${o}-${l.padStart(2,"0")}-${u.padStart(2,"0")}`);return isNaN(f.getTime())?null:f;case"timestamp":const p=Number(t);if(isNaN(p))return null;const g=new Date(p);return isNaN(g.getTime())?null:g;default:const d=new Date(t);return isNaN(d.getTime())?null:d}}catch{return null}}function b(t,e,i=!1){const c=i?String(t):String(t).toLowerCase(),n=i?String(e):String(e).toLowerCase(),a=/(\d+)|(\D+)/g,m=c.match(a)||[],r=n.match(a)||[],s=Math.max(m.length,r.length);for(let l=0;l<s;l++){const u=m[l]||"",o=r[l]||"";if(!u)return-1;if(!o)return 1;const f=Number(u),p=Number(o);if(!isNaN(f)&&!isNaN(p)){if(f!==p)return f-p}else if(u!==o)return u.localeCompare(o)}return 0}function S(t,e,i,c={}){const{dateFormat:n="iso",caseSensitive:a=!1,locale:m="pt-BR"}=c;if(t==null)return 1;if(e==null)return-1;switch(i){case"date":{const r=h(t,n),s=h(e,n);return!r&&!s?0:r?s?r.getTime()-s.getTime():-1:1}case"number":{const r=Number(t),s=Number(e);return isNaN(r)&&isNaN(s)?0:isNaN(r)?1:isNaN(s)?-1:r-s}case"boolean":{const r=!!t;return r===!!e?0:r?1:-1}case"natural":return b(t,e,a);case"string":{const r=a?String(t):String(t).toLowerCase(),s=a?String(e):String(e).toLowerCase();return r.localeCompare(s,m)}case"auto":default:{const r=Number(t),s=Number(e);if(!isNaN(r)&&!isNaN(s))return r-s;{const l=String(t).toLowerCase(),u=String(e).toLowerCase();return l.localeCompare(u,m)}}}}function C({nodeData:t,inputs:e}){let i=y(e["data-input"]);if(!Array.isArray(i))throw new Error("Input deve ser um array");const c=t.fieldMode||"selector";let n;if(c==="custom")n=t.customField;else{const o=t.selectedField;Array.isArray(o)&&o.length>0?n=o[0]:typeof o=="string"&&(n=o)}const a=t.order||"asc",m=t.sortType||"auto",r=t.dateFormat||"iso",s=t.caseSensitive||!1,l=t.locale||"pt-BR",u=[...i];return u.sort((o,f)=>{const p=n?N(o,n):o,g=n?N(f,n):f,d=S(p,g,m,{dateFormat:r,caseSensitive:s,locale:l});return a==="asc"?d:-d}),u}function $(t){const e=[];(t.fieldMode||"selector")==="custom"?t.customField||e.push("Campo customField obrigatório no modo custom"):(!t.selectedField||Array.isArray(t.selectedField)&&t.selectedField.length===0)&&e.push("Seleção de campo obrigatória"),t.order||e.push('Campo "order" obrigatório');const c=["auto","string","number","date","boolean","natural"];if(t.sortType&&!c.includes(t.sortType)&&e.push(`sortType inválido: "${t.sortType}". Deve ser um de: ${c.join(", ")}`),t.sortType==="date"){const n=["iso","iso-datetime","br","us","timestamp"];t.dateFormat&&!n.includes(t.dateFormat)&&e.push(`dateFormat inválido: "${t.dateFormat}". Deve ser um de: ${n.join(", ")}`)}return t.caseSensitive!==void 0&&typeof t.caseSensitive!="boolean"&&e.push('Campo "caseSensitive" deve ser boolean'),{valid:e.length===0,errors:e}}export{C as execute,$ as validate};
