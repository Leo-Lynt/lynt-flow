import{u as m}from"./dataUtils-XrCV_Bny.js";import{g as s}from"./pathUtils-D1qRpIzi.js";import"./index-vfrSo85q.js";function g({nodeData:r,inputs:l}){let t=m(l["data-input"]);if(!Array.isArray(t))throw new Error("Input deve ser um array");const c=r.operation||"sum",a=r.fieldMode||"selector";let i;if(a==="custom")i=r.customField;else{const e=r.selectedField;Array.isArray(e)&&e.length>0?i=e[0]:typeof e=="string"&&(i=e)}switch(c){case"count":return t.length;case"sum":return t.reduce((e,o)=>{const u=i?s(o,i):o,n=Number(u)||0;return e+n},0);case"average":return t.length===0?0:t.reduce((o,u)=>{const n=i?s(u,i):u,f=Number(n)||0;return o+f},0)/t.length;case"min":{if(t.length===0)return null;let e=1/0;return t.forEach(o=>{const u=i?s(o,i):o,n=Number(u);!isNaN(n)&&n<e&&(e=n)}),e===1/0?null:e}case"max":{if(t.length===0)return null;let e=-1/0;return t.forEach(o=>{const u=i?s(o,i):o,n=Number(u);!isNaN(n)&&n>e&&(e=n)}),e===-1/0?null:e}default:throw new Error(`Operação "${c}" não suportada`)}}function y(r){const l=[];return r.operation||l.push('Campo "operation" obrigatório'),["sum","average","min","max"].includes(r.operation)&&((r.fieldMode||"selector")==="custom"?r.customField||l.push(`Operação "${r.operation}" requer campo customField`):(!r.selectedField||Array.isArray(r.selectedField)&&r.selectedField.length===0)&&l.push(`Operação "${r.operation}" requer seleção de campo`)),{valid:l.length===0,errors:l}}export{g as execute,y as validate};
