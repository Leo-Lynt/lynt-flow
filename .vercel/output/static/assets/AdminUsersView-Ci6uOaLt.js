var h=(B,V,f)=>new Promise((R,U)=>{var E=n=>{try{b(f.next(n))}catch(c){U(c)}},I=n=>{try{b(f.throw(n))}catch(c){U(c)}},b=n=>n.done?R(n.value):Promise.resolve(n.value).then(E,I);b((f=f.apply(B,V)).next())});import{r as p,o as X,a as K,s as Y,b as x,k as e,i as v,m as C,l as d,u as r,I as i,t as a,q as k,K as Z,v as ee,J as M,z as j,F as te,C as se,n as P,E as oe}from"./vue-vendor-BR4PrzJp.js";import{_ as re}from"./AppLayout-ufbJ5Vfo.js";import{u as ae}from"./useAdmin-CSfEy-uI.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useAuth-C_Ik1XEG.js";import"./utils-nSMfNdYQ.js";const ie={class:"max-w-7xl mx-auto"},ne={key:0,class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},de={class:"glass-card backdrop-blur-xl bg-white/70 rounded-xl border border-white/40 shadow-sm p-6 hover:bg-white/80 transition-all"},ce={class:"flex items-center justify-between mb-2"},ue={class:"text-3xl font-bold text-gray-900"},pe={class:"glass-card backdrop-blur-xl bg-white/70 rounded-xl border border-white/40 shadow-sm p-6 hover:bg-white/80 transition-all"},xe={class:"flex items-center justify-between mb-2"},be={class:"text-3xl font-bold text-gray-900"},ge={class:"glass-card backdrop-blur-xl bg-white/70 rounded-xl border border-white/40 shadow-sm p-6 hover:bg-white/80 transition-all"},me={class:"flex items-center justify-between mb-2"},ve={class:"text-3xl font-bold text-gray-900"},fe={class:"glass-card backdrop-blur-xl bg-white/70 rounded-xl border border-white/40 shadow-sm p-6 hover:bg-white/80 transition-all"},ye={class:"flex items-center justify-between mb-2"},he={class:"text-3xl font-bold text-gray-900"},we={class:"glass-card backdrop-blur-xl bg-white/70 rounded-xl border border-white/40 shadow-sm p-4 mb-6"},_e={class:"flex flex-col md:flex-row gap-4"},ke={class:"flex-1"},Ue={class:"relative"},Ae={class:"glass-card backdrop-blur-xl bg-white/70 rounded-xl border border-white/40 shadow-sm overflow-hidden"},Ce={class:"overflow-x-auto"},Pe={class:"min-w-full divide-y divide-gray-200"},Ve={class:"bg-white divide-y divide-gray-200"},Re={key:0},Ee={colspan:"6",class:"px-6 py-12 text-center"},Ie={key:1},Se={class:"px-6 py-4 whitespace-nowrap"},Me={class:"flex items-center"},je={class:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center"},Be={class:"text-blue-600 font-semibold"},Te={class:"ml-4"},$e={class:"text-sm font-medium text-gray-900 flex items-center gap-2"},ze={class:"text-sm text-gray-500"},Fe={class:"px-6 py-4 whitespace-nowrap"},De={class:"px-6 py-4 whitespace-nowrap"},Ne={class:"px-6 py-4 whitespace-nowrap"},Ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ge={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Le=["onClick"],Oe=["onClick","title"],qe={key:0,class:"px-6 py-4 border-t border-gray-200 flex items-center justify-between"},Je={class:"text-sm text-gray-700"},Qe={class:"flex gap-2"},He=["disabled"],We=["disabled"],Xe={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Ye={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:p-0"},Ze={class:"relative inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform glass-card backdrop-blur-xl bg-white/90 border border-white/40 shadow-xl rounded-2xl"},et={class:"flex items-start justify-between mb-6"},tt={class:"text-sm text-gray-600 mt-1"},st={class:"space-y-4"},ot={class:"flex items-center gap-2 cursor-pointer"},rt={class:"flex items-center justify-end gap-3 mt-6 pt-6 border-t border-gray-200"},at=["disabled"],lt={__name:"AdminUsersView",setup(B){const{listUsers:V,getUserStats:f,updateUserRole:R,toggleUserStatus:U,toggleVerifiedCreator:E,updateUserPlan:I,loading:b}=ae(),n=p([]),c=p(null),u=p(1),w=p(1),S=p(""),A=p("all"),y=p(!1),g=p(null),l=p({role:"",isActive:!0,currentPlanId:"free"});X(()=>h(null,null,function*(){yield T(),yield m()}));function T(){return h(this,null,function*(){const o=yield f();o.success&&(c.value=o.data)})}function m(){return h(this,null,function*(){const o={page:u.value,limit:20,role:A.value!=="all"?A.value:void 0,search:S.value||void 0},t=yield V(o);t.success&&(n.value=t.data.users,w.value=t.data.pagination.pages)})}function $(){u.value=1,m()}function G(){u.value=1,m()}function L(o){g.value=o,l.value={role:o.role,isActive:o.isActive,currentPlanId:o.currentPlanId||"free"},y.value=!0}function O(){return h(this,null,function*(){if(!g.value)return;const o=g.value._id;if(l.value.role!==g.value.role){const t=yield R(o,l.value.role);if(!t.success){alert("Erro ao atualizar role: "+t.error);return}}if(l.value.isActive!==g.value.isActive){const t=yield U(o,l.value.isActive);if(!t.success){alert("Erro ao atualizar status: "+t.error);return}}if(l.value.currentPlanId!==(g.value.currentPlanId||"free")){const t=yield I(o,l.value.currentPlanId);if(!t.success){alert("Erro ao atualizar plano: "+t.error);return}}y.value=!1,yield m(),yield T()})}function q(o){return h(this,null,function*(){var s;const t=!((s=o.publicProfile)!=null&&s.isVerifiedCreator),_=yield E(o._id,t);_.success?yield m():alert("Erro: "+_.error)})}function z(o){const t={user:{color:"bg-gray-100 text-gray-700 border border-gray-300",label:"Usuário"},moderator:{color:"bg-cyan-500/10 text-cyan-700 border border-cyan-500/30",label:"Moderador"},administrator:{color:"bg-orange-500/10 text-orange-700 border border-orange-500/30",label:"Administrador"}};return t[o]||t.user}function F(o){const t={free:{color:"bg-gray-100 text-gray-700 border border-gray-300",label:"FREE"},starter:{color:"bg-blue-100 text-blue-700 border border-blue-300",label:"STARTER"},pro:{color:"bg-purple-100 text-purple-700 border border-purple-300",label:"PRO"}};return t[o]||t.free}function J(o){return new Date(o).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})}function Q(){u.value<w.value&&(u.value++,m())}function H(){u.value>1&&(u.value--,m())}return(o,t)=>(x(),K(re,null,{default:Y(()=>{var _;return[e("div",ie,[t[16]||(t[16]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-semibold text-gray-800 mb-2 tracking-wide"},"Gerenciamento de Usuários"),e("p",{class:"text-gray-600 tracking-wide"},"Gerencie usuários, roles e permissões")],-1)),c.value?(x(),v("div",ne,[e("div",de,[e("div",ce,[t[8]||(t[8]=e("span",{class:"text-sm font-medium text-gray-700 tracking-wide"},"Total de Usuários",-1)),d(r(i),{icon:"lucide:users",class:"w-5 h-5 text-blue-600"})]),e("p",ue,a(c.value.totalUsers),1)]),e("div",pe,[e("div",xe,[t[9]||(t[9]=e("span",{class:"text-sm font-medium text-gray-700 tracking-wide"},"Usuários Ativos",-1)),d(r(i),{icon:"lucide:check-circle",class:"w-5 h-5 text-green-600"})]),e("p",be,a(c.value.activeUsers),1)]),e("div",ge,[e("div",me,[t[10]||(t[10]=e("span",{class:"text-sm font-medium text-gray-700 tracking-wide"},"Moderadores",-1)),d(r(i),{icon:"lucide:shield",class:"w-5 h-5 text-cyan-600"})]),e("p",ve,a(c.value.roleStats.moderator),1)]),e("div",fe,[e("div",ye,[t[11]||(t[11]=e("span",{class:"text-sm font-medium text-gray-700 tracking-wide"},"Administradores",-1)),d(r(i),{icon:"lucide:crown",class:"w-5 h-5 text-orange-600"})]),e("p",he,a(c.value.roleStats.administrator),1)])])):C("",!0),e("div",we,[e("div",_e,[e("div",ke,[e("div",Ue,[d(r(i),{icon:"lucide:search",class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),k(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>S.value=s),onKeyup:Z($,["enter"]),type:"text",placeholder:"Buscar por nome ou email...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,544),[[ee,S.value]])])]),k(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>A.value=s),onChange:G,class:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[...t[12]||(t[12]=[e("option",{value:"all"},"Todos os roles",-1),e("option",{value:"user"},"Usuários",-1),e("option",{value:"moderator"},"Moderadores",-1),e("option",{value:"administrator"},"Administradores",-1)])],544),[[M,A.value]]),e("button",{onClick:$,class:"px-6 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white rounded-lg transition-all shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 flex items-center gap-2"},[d(r(i),{icon:"lucide:search",class:"w-5 h-5"}),t[13]||(t[13]=j(" Buscar ",-1))])])]),e("div",Ae,[e("div",Ce,[e("table",Pe,[t[15]||(t[15]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Usuário "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Role "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Plano "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Criado em "),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ações ")])],-1)),e("tbody",Ve,[r(b)?(x(),v("tr",Re,[e("td",Ee,[d(r(i),{icon:"lucide:loader-2",class:"w-8 h-8 text-blue-600 animate-spin mx-auto"})])])):n.value.length===0?(x(),v("tr",Ie,[...t[14]||(t[14]=[e("td",{colspan:"6",class:"px-6 py-12 text-center text-gray-500"}," Nenhum usuário encontrado ",-1)])])):(x(!0),v(te,{key:2},se(n.value,s=>{var D,N;return x(),v("tr",{key:s._id,class:"hover:bg-gray-50"},[e("td",Se,[e("div",Me,[e("div",je,[e("span",Be,a(s.name.charAt(0).toUpperCase()),1)]),e("div",Te,[e("div",$e,[j(a(s.name)+" ",1),(D=s.publicProfile)!=null&&D.isVerifiedCreator?(x(),K(r(i),{key:0,icon:"lucide:badge-check",class:"w-4 h-4 text-blue-500",title:"Criador Verificado"})):C("",!0)]),e("div",ze,a(s.email),1)])])]),e("td",Fe,[e("span",{class:P(["px-2 py-1 text-xs font-medium rounded-full",z(s.role).color])},a(z(s.role).label),3)]),e("td",De,[e("span",{class:P(["px-2 py-1 text-xs font-medium rounded-full",F(s.currentPlanId||"free").color])},a(F(s.currentPlanId||"free").label),3)]),e("td",Ne,[e("span",{class:P(["px-2 py-1 text-xs font-medium rounded-full",s.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},a(s.isActive?"Ativo":"Inativo"),3)]),e("td",Ke,a(J(s.createdAt)),1),e("td",Ge,[e("button",{onClick:W=>L(s),class:"text-blue-600 hover:text-blue-900 mr-4",title:"Editar usuário"},[d(r(i),{icon:"lucide:edit",class:"w-5 h-5"})],8,Le),e("button",{onClick:W=>q(s),class:"text-purple-600 hover:text-purple-900",title:(N=s.publicProfile)!=null&&N.isVerifiedCreator?"Remover verificação":"Verificar criador"},[d(r(i),{icon:"lucide:badge-check",class:"w-5 h-5"})],8,Oe)])])}),128))])])]),w.value>1?(x(),v("div",qe,[e("div",Je," Página "+a(u.value)+" de "+a(w.value),1),e("div",Qe,[e("button",{onClick:H,disabled:u.value===1,class:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Anterior ",8,He),e("button",{onClick:Q,disabled:u.value===w.value,class:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Próxima ",8,We)])])):C("",!0)])]),y.value?(x(),v("div",Xe,[e("div",Ye,[e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t[2]||(t[2]=s=>y.value=!1)}),e("div",Ze,[e("div",et,[e("div",null,[t[17]||(t[17]=e("h3",{class:"text-xl font-bold text-gray-900"},"Editar Usuário",-1)),e("p",tt,a((_=g.value)==null?void 0:_.name),1)]),e("button",{onClick:t[3]||(t[3]=s=>y.value=!1),class:"text-gray-400 hover:text-gray-600"},[d(r(i),{icon:"lucide:x",class:"w-6 h-6"})])]),e("div",st,[e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Role",-1)),k(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.value.role=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[...t[18]||(t[18]=[e("option",{value:"user"},"Usuário",-1),e("option",{value:"moderator"},"Moderador",-1),e("option",{value:"administrator"},"Administrador",-1)])],512),[[M,l.value.role]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Plano",-1)),k(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.currentPlanId=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[...t[20]||(t[20]=[e("option",{value:"free"},"FREE",-1),e("option",{value:"starter"},"STARTER (R$ 35,90/mês)",-1),e("option",{value:"pro"},"PRO (R$ 130/mês)",-1)])],512),[[M,l.value.currentPlanId]]),t[22]||(t[22]=e("p",{class:"text-xs text-gray-500 mt-1"}," Alterar o plano atualiza automaticamente os limites do usuário ",-1))]),e("div",null,[e("label",ot,[k(e("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=s=>l.value.isActive=s),class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 focus:border-transparent"},null,512),[[oe,l.value.isActive]]),t[23]||(t[23]=e("span",{class:"text-sm font-medium text-gray-700"},"Usuário ativo",-1))])])]),e("div",rt,[e("button",{onClick:t[7]||(t[7]=s=>y.value=!1),class:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50"}," Cancelar "),e("button",{onClick:O,disabled:r(b),class:"px-4 py-2.5 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white rounded-lg transition-all shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 disabled:opacity-50 flex items-center gap-2"},[d(r(i),{icon:r(b)?"lucide:loader-2":"lucide:save",class:P(["w-4 h-4",{"animate-spin":r(b)}])},null,8,["icon","class"]),t[24]||(t[24]=j(" Salvar ",-1))],8,at)])])])])):C("",!0)]}),_:1}))}},bt=le(lt,[["__scopeId","data-v-5998e1a4"]]);export{bt as default};
