var re=Object.defineProperty;var Z=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var ee=(l,p,c)=>p in l?re(l,p,{enumerable:!0,configurable:!0,writable:!0,value:c}):l[p]=c,V=(l,p)=>{for(var c in p||(p={}))oe.call(p,c)&&ee(l,c,p[c]);if(Z)for(var c of Z(p))le.call(p,c)&&ee(l,c,p[c]);return l};var f=(l,p,c)=>new Promise((_,F)=>{var $=i=>{try{y(c.next(i))}catch(g){F(g)}},I=i=>{try{y(c.throw(i))}catch(g){F(g)}},y=i=>i.done?_(i.value):Promise.resolve(i.value).then($,I);y((c=c.apply(l,p)).next())});import{c as se,r as z,A as ie,i as x,m as S,b as k,k as s,l as v,u as d,I as w,t as b,z as j,n as U,q as ae,M as te}from"./vue-vendor-BR4PrzJp.js";import{a as m}from"./useAuth-C_Ik1XEG.js";const n=z(!1),o=z(null);function ne(){function l(){return f(this,arguments,function*(e={}){var t,r;try{n.value=!0,o.value=null;const a=new URLSearchParams;e.search&&a.append("search",e.search),e.category&&a.append("category",e.category),e.difficulty&&a.append("difficulty",e.difficulty),e.tags&&e.tags.length>0&&a.append("tags",e.tags.join(",")),e.verifiedOnly&&a.append("verifiedOnly","true"),e.sortBy&&a.append("sortBy",e.sortBy),e.page&&a.append("page",e.page),e.limit&&a.append("limit",e.limit);const u=yield m.get(`/public-flows?${a.toString()}`);return V({success:!0},u.data.data)}catch(a){return o.value=((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"Erro ao carregar flows públicos",{success:!1,error:o.value}}finally{n.value=!1}})}function p(e){return f(this,null,function*(){var t,r;try{n.value=!0,o.value=null;const a=yield m.get(`/public-flows/${e}`);return V({success:!0},a.data.data)}catch(a){return o.value=((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"Erro ao carregar detalhes do flow",{success:!1,error:o.value}}finally{n.value=!1}})}function c(e,t){return f(this,null,function*(){var r,a,u,B,C;try{return n.value=!0,o.value=null,{success:!0,data:(yield m.post(`/public-flows/${e}/publish`,t)).data.data}}catch(R){o.value=((a=(r=R.response)==null?void 0:r.data)==null?void 0:a.message)||"Erro ao publicar flow";const L=((C=(B=(u=R.response)==null?void 0:u.data)==null?void 0:B.error)==null?void 0:C.data)||{};return V({success:!1,error:o.value},L)}finally{n.value=!1}})}function _(e){return f(this,null,function*(){var t,r;try{return n.value=!0,o.value=null,{success:!0,data:(yield m.post(`/public-flows/${e}/unpublish`)).data.data}}catch(a){return o.value=((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"Erro ao despublicar flow",{success:!1,error:o.value}}finally{n.value=!1}})}function F(e){return f(this,null,function*(){var t,r;try{return n.value=!0,o.value=null,{success:!0,data:(yield m.post(`/public-flows/${e}/import`)).data.data}}catch(a){return o.value=((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"Erro ao importar flow",{success:!1,error:o.value}}finally{n.value=!1}})}function $(e){return f(this,null,function*(){var t,r;try{return n.value=!0,o.value=null,{success:!0,data:(yield m.post(`/public-flows/${e}/fork`)).data.data}}catch(a){return o.value=((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"Erro ao criar fork",{success:!1,error:o.value}}finally{n.value=!1}})}function I(){return f(this,null,function*(){try{return{success:!0,data:(yield m.get("/public-flows/stats")).data.data}}catch(e){return{success:!1,error:"Erro ao carregar estatísticas"}}})}function y(r){return f(this,arguments,function*(e,t={}){try{const a=new URLSearchParams;t.sortBy&&a.append("sortBy",t.sortBy),t.page&&a.append("page",t.page),t.limit&&a.append("limit",t.limit),t.minRating&&a.append("minRating",t.minRating);const u=yield m.get(`/public-flows/${e}/reviews?${a.toString()}`);return V({success:!0},u.data.data)}catch(a){return{success:!1,error:"Erro ao carregar reviews"}}})}function i(e,t){return f(this,null,function*(){var r,a;try{return n.value=!0,o.value=null,{success:!0,data:(yield m.post(`/public-flows/${e}/reviews`,t)).data.data}}catch(u){return o.value=((a=(r=u.response)==null?void 0:r.data)==null?void 0:a.message)||"Erro ao criar review",{success:!1,error:o.value}}finally{n.value=!1}})}function g(e,t){return f(this,null,function*(){var r,a;try{return n.value=!0,o.value=null,{success:!0,data:(yield m.put(`/public-flows/reviews/${e}`,t)).data.data}}catch(u){return o.value=((a=(r=u.response)==null?void 0:r.data)==null?void 0:a.message)||"Erro ao atualizar review",{success:!1,error:o.value}}finally{n.value=!1}})}function E(e){return f(this,null,function*(){var t,r;try{return n.value=!0,o.value=null,yield m.delete(`/public-flows/reviews/${e}`),{success:!0}}catch(a){return o.value=((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"Erro ao deletar review",{success:!1,error:o.value}}finally{n.value=!1}})}function P(e){return f(this,null,function*(){try{return{success:!0,data:(yield m.post(`/public-flows/reviews/${e}/helpful`)).data.data}}catch(t){return{success:!1,error:"Erro ao marcar review"}}})}function M(e){return f(this,null,function*(){try{return{success:!0,data:(yield m.get(`/public-flows/${e}/reviews/me`)).data.data}}catch(t){return{success:!1,error:"Erro ao carregar review"}}})}function h(e,t){return f(this,null,function*(){var r,a;try{return n.value=!0,o.value=null,{success:!0,data:(yield m.post(`/public-flows/${e}/report`,t)).data.data}}catch(u){return o.value=((a=(r=u.response)==null?void 0:r.data)==null?void 0:a.message)||"Erro ao reportar flow",{success:!1,error:o.value}}finally{n.value=!1}})}return{loading:se(()=>n.value),error:se(()=>o.value),listPublicFlows:l,getFlowDetails:p,publishFlow:c,unpublishFlow:_,importFlow:F,forkFlow:$,getLibraryStats:I,listReviews:y,createReview:i,updateReview:g,deleteReview:E,markReviewHelpful:P,getUserReview:M,reportFlow:h}}const ce={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},ue={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:p-0"},de={class:"relative inline-block w-full max-w-2xl p-6 my-8 overflow-hidden text-left align-middle transition-all transform glass-card backdrop-blur-xl bg-white/90 border border-white/40 shadow-2xl rounded-2xl"},pe={key:0,class:"text-center py-8"},fe={class:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-500/10 border border-green-500/30 mb-4"},me={class:"text-lg font-semibold text-gray-900 mb-2 tracking-wide"},ve={key:1},we={class:"flex items-start justify-between mb-6"},ge={class:"text-gray-600 tracking-wide"},be={key:0,class:"mb-6 p-4 bg-red-500/10 border border-red-500/30 rounded-lg"},ye={class:"flex items-start"},he={class:"text-red-600"},xe={class:"mb-6 p-4 bg-white/50 border border-gray-200 rounded-lg"},ke={class:"flex items-start gap-4"},_e={class:"flex-shrink-0"},Fe={class:"w-12 h-12 bg-gradient-to-br from-blue-600 to-cyan-600 rounded-lg flex items-center justify-center shadow-lg shadow-blue-500/30"},Ee={class:"flex-1"},Re={class:"font-semibold text-gray-900 mb-1"},$e={class:"text-sm text-gray-600 mb-2"},Ie={class:"flex items-center gap-4 text-sm text-gray-500"},Me={class:"flex items-center gap-1"},Be={class:"flex items-center gap-1"},Ce={class:"flex items-center gap-1"},Ve={class:"mb-6"},Se={class:"space-y-3"},je={class:"ml-3 flex-1"},ze={class:"flex items-center gap-2 mb-1"},Le={class:"ml-3 flex-1"},Pe={class:"flex items-center gap-2 mb-1"},Te={key:1,class:"p-4 bg-gray-50 border border-gray-200 rounded-lg"},Ue={class:"text-sm text-gray-600 flex items-center gap-2"},Ae={class:"mb-6 space-y-3"},De={class:"bg-orange-500/10 border border-orange-500/30 rounded-lg p-4"},Ne={class:"flex items-start"},Oe={class:"text-sm text-gray-700"},qe={class:"list-disc list-inside space-y-1"},He={key:0},Ge={class:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4"},Je={class:"flex items-start"},Ke={class:"text-sm text-gray-700"},Qe={class:"font-medium mb-1 text-blue-600"},We={class:"flex items-center justify-end gap-3 pt-6 border-t border-gray-200"},Xe=["disabled"],ss={__name:"ImportFlowModal",props:{show:Boolean,flow:Object},emits:["close","imported"],setup(l,{emit:p}){const c=l,_=p,F=ie(),{importFlow:$,forkFlow:I,loading:y}=ne(),i=z("import"),g=z(""),E=z(!1);function P(){return f(this,null,function*(){g.value="",E.value=!1;let h;i.value==="fork"?h=yield I(c.flow._id):h=yield $(c.flow._id),h.success?(E.value=!0,_("imported",h.data),setTimeout(()=>{F.push(`/flows/${h.data._id}/edit`)},1500)):g.value=h.error})}function M(){i.value="import",g.value="",E.value=!1,_("close")}return(h,e)=>{var t,r,a,u,B,C,R,L,A,D,N,O,q,H,G,J,K,Q,W,X,Y;return l.show?(k(),x("div",ce,[s("div",ue,[s("div",{class:"fixed inset-0 transition-opacity bg-gray-900/50 backdrop-blur-sm",onClick:M}),s("div",de,[E.value?(k(),x("div",pe,[s("div",fe,[v(d(w),{icon:"lucide:check-circle",class:"w-10 h-10 text-green-600"})]),s("h3",me,b(i.value==="fork"?"Fork criado com sucesso!":"Flow importado com sucesso!"),1),e[2]||(e[2]=s("p",{class:"text-gray-600 tracking-wide"}," Redirecionando para o editor... ",-1))])):(k(),x("div",ve,[s("div",we,[s("div",null,[e[3]||(e[3]=s("h3",{class:"text-2xl font-bold text-gray-900 mb-2 tracking-wide"}," Importar Flow ",-1)),s("p",ge,b((t=l.flow)==null?void 0:t.name),1)]),s("button",{onClick:M,class:"text-gray-500 hover:text-gray-700 hover:bg-gray-100/50 p-1.5 rounded-lg transition-all"},[v(d(w),{icon:"lucide:x",class:"w-6 h-6"})])]),g.value?(k(),x("div",be,[s("div",ye,[v(d(w),{icon:"lucide:alert-circle",class:"w-5 h-5 text-red-600 mt-0.5 mr-2"}),s("p",he,b(g.value),1)])])):S("",!0),s("div",xe,[s("div",ke,[s("div",_e,[s("div",Fe,[v(d(w),{icon:"lucide:workflow",class:"w-6 h-6 text-white"})])]),s("div",Ee,[s("h4",Re,b((r=l.flow)==null?void 0:r.name),1),s("p",$e,b((a=l.flow)==null?void 0:a.description),1),s("div",Ie,[s("span",Me,[v(d(w),{icon:"lucide:user",class:"w-4 h-4"}),j(" "+b((C=(B=(u=l.flow)==null?void 0:u.publicMetadata)==null?void 0:B.author)==null?void 0:C.name),1)]),s("span",Be,[v(d(w),{icon:"lucide:download",class:"w-4 h-4"}),j(" "+b(((L=(R=l.flow)==null?void 0:R.publicStats)==null?void 0:L.imports)||0)+" imports ",1)]),s("span",Ce,[v(d(w),{icon:"lucide:star",class:"w-4 h-4 text-yellow-500"}),j(" "+b(((N=(D=(A=l.flow)==null?void 0:A.publicStats)==null?void 0:D.averageRating)==null?void 0:N.toFixed(1))||0),1)])])])])]),s("div",Ve,[e[9]||(e[9]=s("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Escolha o tipo de importação: ",-1)),s("div",Se,[s("label",{class:U(["flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500/50 transition-colors",i.value==="import"?"border-blue-500 bg-blue-50":"border-gray-200"])},[ae(s("input",{"onUpdate:modelValue":e[0]||(e[0]=T=>i.value=T),type:"radio",value:"import",class:"mt-1 w-5 h-5 text-blue-600 accent-blue-600"},null,512),[[te,i.value]]),s("div",je,[s("div",ze,[v(d(w),{icon:"lucide:download",class:"w-5 h-5 text-blue-600"}),e[4]||(e[4]=s("p",{class:"font-medium text-gray-900"},"Importar (recomendado)",-1))]),e[5]||(e[5]=s("p",{class:"text-sm text-gray-600"}," Cria uma cópia independente do flow. Você não receberá atualizações do original. ",-1))])],2),(q=(O=l.flow)==null?void 0:O.publicMetadata)!=null&&q.allowForking?(k(),x("label",{key:0,class:U(["flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-cyan-500/50 transition-colors",i.value==="fork"?"border-cyan-500 bg-cyan-50":"border-gray-200"])},[ae(s("input",{"onUpdate:modelValue":e[1]||(e[1]=T=>i.value=T),type:"radio",value:"fork",class:"mt-1 w-5 h-5 text-cyan-600 accent-cyan-600"},null,512),[[te,i.value]]),s("div",Le,[s("div",Pe,[v(d(w),{icon:"lucide:git-fork",class:"w-5 h-5 text-cyan-600"}),e[6]||(e[6]=s("p",{class:"font-medium text-gray-900"},"Fork",-1))]),e[7]||(e[7]=s("p",{class:"text-sm text-gray-600"}," Cria um fork mantendo referência ao original. Você será notificado de atualizações. ",-1))])],2)):S("",!0),(G=(H=l.flow)==null?void 0:H.publicMetadata)!=null&&G.allowForking?S("",!0):(k(),x("div",Te,[s("p",Ue,[v(d(w),{icon:"lucide:info",class:"w-4 h-4"}),e[8]||(e[8]=j(" Este flow não permite forks. Apenas importação está disponível. ",-1))])]))])]),s("div",Ae,[s("div",De,[s("div",Ne,[v(d(w),{icon:"lucide:alert-triangle",class:"w-5 h-5 text-orange-600 mt-0.5 mr-2 flex-shrink-0"}),s("div",Oe,[e[12]||(e[12]=s("p",{class:"font-medium mb-1 text-orange-600"},"Importante:",-1)),s("ul",qe,[e[10]||(e[10]=s("li",null,"Você precisará configurar suas próprias credenciais (API keys, senhas, etc.)",-1)),e[11]||(e[11]=s("li",null,"O flow importado será privado e não afetará o original",-1)),(K=(J=l.flow)==null?void 0:J.publicMetadata)!=null&&K.requireAttribution?(k(),x("li",He,"Este flow requer atribuição ao autor original")):S("",!0)])])])]),s("div",Ge,[s("div",Je,[v(d(w),{icon:"lucide:scale",class:"w-5 h-5 text-blue-600 mt-0.5 mr-2 flex-shrink-0"}),s("div",Ke,[s("p",Qe,"Licença: "+b(((W=(Q=l.flow)==null?void 0:Q.publicMetadata)==null?void 0:W.license)||"MIT"),1),s("p",null,"Este flow está licenciado sob "+b(((Y=(X=l.flow)==null?void 0:X.publicMetadata)==null?void 0:Y.license)||"MIT License")+".",1)])])])]),s("div",We,[s("button",{onClick:M,type:"button",class:"px-6 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 font-medium transition-all"}," Cancelar "),s("button",{onClick:P,type:"button",disabled:d(y),class:"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white rounded-lg disabled:opacity-50 flex items-center gap-2 shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 font-medium transition-all"},[v(d(w),{icon:d(y)?"lucide:loader-2":i.value==="fork"?"lucide:git-fork":"lucide:download",class:U(["w-4 h-4",{"animate-spin":d(y)}])},null,8,["icon","class"]),j(" "+b(d(y)?"Importando...":i.value==="fork"?"Criar Fork":"Importar Flow"),1)],8,Xe)])]))])])])):S("",!0)}}};export{ss as _,ne as u};
