import{m as T}from"./mappings-r9Y49qnX.js";import{g}from"./index-aSFpVsIL.js";class m{async fetch(t,e){throw new Error("IDataSource.fetch() must be implemented")}validate(t){throw new Error("IDataSource.validate() must be implemented")}getSourceType(){throw new Error("IDataSource.getSourceType() must be implemented")}}class S extends m{constructor(t){super();const e=t||`${g()}/api`;this.apiBaseUrl=e,this.sourceType=null}async fetch(t,e){var s,a,c;const p=`${this.apiBaseUrl}/connectors/execute`,o=(s=e.apiConfig)==null?void 0:s.token,l=this.getSourceType(),d=T(l),{sourceType:f,...h}=t;try{const r=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json",...o&&{Authorization:`Bearer ${o}`},...e.userId&&{"X-User-Id":e.userId}},body:JSON.stringify({sourceType:d,config:h,userId:e.userId})});if(!r.ok){const y=await r.json().catch(()=>({}));throw new Error(y.message||`HTTP ${r.status}: ${r.statusText}`)}const n=await r.json();return((c=(a=n.data)==null?void 0:a.result)==null?void 0:c.data)||n.data}catch(r){throw console.error(`âŒ HttpDataSource fetch error (${this.getSourceType()}):`,r.message),r}}validate(t){return{valid:!0,errors:[]}}getSourceType(){return this.sourceType}}class u{static create(t){const e=new S;return e.sourceType=t,e}static createAll(){return["google_sheets","google_analytics","api","json","csv","graphql","database","mk3d"].map(e=>({type:e,adapter:u.create(e)}))}}export{S as HttpDataSource,u as HttpDataSourceFactory};
