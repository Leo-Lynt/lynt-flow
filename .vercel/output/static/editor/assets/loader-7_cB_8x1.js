import{f,g as l,h,i as g}from"./index-aSFpVsIL.js";let u=!1,p=null;function d(e){const r=[];return e?(e.version||r.push('Campo "version" obrigatório não encontrado'),(!e.nodes||!Array.isArray(e.nodes))&&r.push('Campo "nodes" deve ser um array'),e.categories&&!Array.isArray(e.categories)&&r.push('Campo "categories" deve ser um array'),e.nodes&&e.nodes.forEach((o,a)=>{o.type||r.push(`Node no índice ${a} não possui campo "type"`),o.label||r.push(`Node "${o.type||a}" não possui campo "label"`),o.method||r.push(`Node "${o.type||a}" não possui campo "method"`),o.category||r.push(`Node "${o.type||a}" não possui campo "category"`)}),{valid:r.length===0,errors:r}):(r.push("Catálogo está vazio ou inválido"),{valid:!1,errors:r})}async function y(e){var r;if(u)return p;try{const o=e||l(),i=await fetch(`${o}/api/nodes`);if(!i.ok)throw new Error(`Erro ao carregar catálogo: ${i.status} ${i.statusText}`);const n=await i.json();if(!n.success)throw new Error(`API error: ${((r=n.error)==null?void 0:r.message)||"Unknown error"}`);const s=n.data,c=d(s);if(!c.valid)throw new Error(`Catálogo inválido: ${c.errors.join(", ")}`);return s.categories&&s.categories.forEach(t=>{h(t.id,t)}),s.nodes.forEach(t=>{g(t.type,t)}),u=!0,p=s,s}catch(o){throw o}}async function v(){try{return{success:!0,catalog:await y(),stats:f.getStats()}}catch(e){return{success:!1,error:e.message}}}export{v as initializeEngine,y as loadNodeCatalog};
